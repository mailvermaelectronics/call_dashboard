<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Secure Login - Call Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />


<style>
  /* Global Reset and Typography */
  body{
    font-family:'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    /* Updated for a more professional and soothing background */
    background:#f4f7fa; 
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    margin:0;
  }
  
  /* Login Container Box */
  .box{
    background:#ffffff;
    padding:40px;
    width:100%;
    max-width:400px; /* Slightly wider box */
    border-radius:12px; /* Slightly reduced border radius for modern look */
    /* Updated shadow for a cleaner lift-off effect */
    box-shadow:0 8px 25px rgba(0,0,0,0.1); 
    transition:transform 0.3s ease;
    border-top: 4px solid #007bff; /* Professional accent line */
  }

  /* Logo Styling */
  .logo-container {
    text-align: center;
    margin-bottom: 25px;
    background-color: #ffffff; 
  }
  .logo {
    width: auto; 
    max-height: 70px; /* Slightly smaller logo */
    display: inline-block;
    background-color: transparent !important; 
    border: none !important; 
  }

  /* Headings */
  h2{
    text-align:center;
    color:#1f2937;
    margin-bottom: 30px; /* Increased margin for spacing */
    font-weight: 700;
    font-size: 26px; /* Slightly larger heading */
  }
  
  /* Input Fields */
  /* FIX: Changed width to 100% and relied on padding inside the box */
  input{
    width:100%; 
    padding:14px 12px; /* Increased padding */
    margin-top:15px;
    border-radius:8px; /* Slightly reduced border radius */
    border:1px solid #d1d5db; /* Softer border color */
    transition:border-color 0.3s, box-shadow 0.3s;
    font-size:16px;
    color:#374151;
    box-sizing: border-box; 
  }
  /* Focus color matches a professional blue (#007bff) */
  input:focus{
    border-color:#007bff; 
    outline:none;
    box-shadow:0 0 0 3px rgba(0, 123, 255, 0.2);
  }

  /* Password Container: To hold both input and toggle button */
  .password-container {
    position: relative;
    margin-top: 15px; 
    /* FIX: Added box-sizing here too for consistency */
    box-sizing: border-box; 
  }
  
  /* Password Input inside the container (resets width and padding) */
  .password-container input {
    margin-top: 0; 
    width: 100%; /* FIX: Ensures it takes full container width */
    padding-right: 45px; /* Space for the icon */
    box-sizing: border-box; /* FIX: Applied box-sizing here */
  }
  
  /* Toggle Button Styling (Positioned absolutely inside the container) */
  .toggle-password {
    position: absolute;
    right: 5px; 
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    color: #9ca3af; /* Muted icon color */
    line-height: 1;
    padding: 10px; 
    z-index: 10;
    transition: color 0.2s ease; /* Added transition for hover effect */
  }
  .toggle-password:hover {
    color: #1f2937;
  }

  /* Material Symbol Icons Styling */
  .material-symbols-outlined {
    font-variation-settings:
      'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24;
    font-size: 24px; 
  }
  
  /* Button Styling */
  button[type="submit"], button[onclick="login()"] { /* Targets the login button */
    width:100%;
    padding:14px;
    margin-top:30px; /* Increased margin */
    border:0;
    border-radius:8px;
    background:#007bff; /* Professional blue color */
    color:#fff;
    font-weight:600;
    cursor:pointer;
    font-size:17px; /* Slightly larger font */
    transition:background-color 0.3s, box-shadow 0.3s;
  }
  button[type="submit"]:hover, button[onclick="login()"]:hover{
    background:#0056b3; /* Darker hover blue */
    box-shadow:0 6px 20px rgba(0, 123, 255, 0.4);
  }
  button[type="submit"]:disabled {
    background-color: #99cfff;
    cursor: not-allowed;
    box-shadow: none;
  }
  
  /* Muted Text */
  .muted{
    font-size:13px; /* Slightly smaller */
    color:#9ca3af; /* Muted text color */
    margin-top:20px;
    text-align:center;
  }
  
  /* Message Area */
  #msg{
    margin-top:20px;
    font-size:15px;
    text-align:center;
    padding:12px; /* Increased padding */
    border-radius:8px;
    /* Added border */
    border: 1px solid transparent; 
  }
  /* Specific message colors */
  #msg[style*="991b1b"] { /* Error */
    border-color: #fca5a5;
  }
  #msg[style*="065f46"] { /* Success */
    border-color: #6ee7b7;
  }
</style>

</head>
<body>
<div class="box">

  <div class="logo-container">
    <img src="res/logo.png" alt="Company Logo" class="logo"> 
  </div>

  <h2>ðŸ“ž Dashboard Login</h2>
  
  <form id="loginForm" onsubmit="login(event)">
    <div id="loginBox">
      <input id="username" placeholder="Username" autocomplete="username" required>
      
      <div class="password-container">
        <input id="password" type="password" placeholder="Password" autocomplete="current-password" required>
        <button type="button" class="toggle-password" onclick="togglePasswordVisibility()">
          <span id="toggleIcon" class="material-symbols-outlined">visibility_off</span>
        </button>
      </div>
      
      <button type="submit">Secure Login</button>
      <div class="muted">Enter correct username & password to access the secure dashboard.</div>
    </div>
  </form>

  <div id="msg"></div>

</div>

<script>
// USER DATA (same as before)
const USERS = {
  "admin": {
     // password = admin123
     passwordHash: "9667a43bca5f7472d3e1b25c1cf6f831960c9bdd5eaaf19a99d426f9739b29e1",
  }
};

// SHA-256 hash
async function sha256hex(str){
  const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
}

// show message
function msg(text, bad=false){
  const m = document.getElementById("msg");
  m.style.color = bad ? "#991b1b" : "#065f46"; 
  m.style.backgroundColor = bad ? "#fee2e2" : "#d1fae5";
  m.innerText = text;
}

// Function to toggle password visibility 
function togglePasswordVisibility() {
  const passwordInput = document.getElementById('password');
  const toggleIcon = document.getElementById('toggleIcon');
  
  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    // Change icon to visibility (Shown state)
    toggleIcon.innerText = 'visibility'; 
  } else {
    passwordInput.type = 'password';
    // Change icon back to visibility_off (Hidden state)
    toggleIcon.innerText = 'visibility_off'; 
  }
}


// login function (Updated to accept event object)
async function login(event){
  // Prevent default form submission behavior (which causes page reload)
  if (event) {
    event.preventDefault();
  }

  msg("");

  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value;

  // Disable button during process
  const loginButton = document.querySelector('button[type="submit"]');
  loginButton.disabled = true;

  if(!u || !p){ 
    msg("Please enter both username and password.", true); 
    loginButton.disabled = false;
    return; 
  }

  const user = USERS[u];
  if(!user){ 
    msg("Invalid credentials. Please check your details.", true); 
    loginButton.disabled = false;
    return; 
  }

  try {
    const hash = await sha256hex(p);
    if(hash !== user.passwordHash){ 
      msg("Invalid credentials. Please check your details.", true); 
      loginButton.disabled = false;
      return;
    }
  } catch (error) {
    // Handle potential hashing errors
    msg("An error occurred during authentication.", true);
    loginButton.disabled = false;
    return;
  }

  // SUCCESS
  msg("Login successful! Redirecting to dashboard...", false);

  // FIX: Using sessionStorage instead of localStorage
  sessionStorage.setItem("auth", "1");

  setTimeout(()=>{
    window.location.href = "dashboard.html";
  }, 600);
}
</script>

</body>
</html>
