<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Secure Login - Call Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />


<style>
  /* Global Reset and Typography */
  body{
    font-family:'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    background:#eef1f6;
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    margin:0;
  }
  
  /* Login Container Box */
  .box{
    background:#ffffff;
    padding:40px;
    width:100%;
    max-width:380px;
    border-radius:16px;
    box-shadow:0 10px 30px rgba(0,0,0,0.08);
    transition:transform 0.3s ease;
  }

  /* Logo Styling */
  .logo-container {
    text-align: center;
    margin-bottom: 25px;
    background-color: #ffffff; 
  }
  .logo {
    width: auto; 
    max-height: 80px; 
    display: inline-block;
    background-color: transparent !important; 
    border: none !important; 
  }

  /* Headings */
  h2{
    text-align:center;
    color:#1f2937;
    margin-bottom: 20px;
    font-weight: 700;
    font-size: 24px;
  }
  
  /* Input Fields */
  input{
    width:calc(100% - 20px);
    padding:12px 10px;
    margin-top:15px;
    border-radius:10px;
    border:1px solid #e5e7eb;
    transition:border-color 0.3s, box-shadow 0.3s;
    font-size:16px;
    color:#374151;
  }
  input:focus{
    border-color:#2563eb;
    outline:none;
    box-shadow:0 0 0 3px rgba(37, 99, 235, 0.2);
  }

  /* Password Container: To hold both input and toggle button */
  .password-container {
    position: relative;
    /* This makes the container act like the input field itself, 
       ensuring proper spacing between inputs. */
    margin-top: 15px; 
  }
  
  /* Password Input inside the container */
  .password-container input {
    margin-top: 0; /* Remove redundant margin */
    /* Adjust width and padding to make space for the toggle button inside the border */
    width: 100%; 
    padding-right: 45px; /* Enough space for the icon and padding */
    box-sizing: border-box; /* Include padding/border in the element's total width/height */
  }
  
  /* Toggle Button Styling (Positioned absolutely inside the container) */
  .toggle-password {
    position: absolute;
    right: 5px; /* Adjust spacing from the right border */
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    line-height: 1;
    padding: 10px; 
    z-index: 10;
  }
  .toggle-password:hover {
    color: #1f2937;
  }

  /* Material Symbol Icons Styling */
  .material-symbols-outlined {
    font-variation-settings:
      'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24;
    font-size: 24px; /* Icon size */
  }
  
  /* Button Styling */
  button[onclick="login()"]{
    width:100%;
    padding:14px;
    margin-top:25px;
    border:0;
    border-radius:10px;
    background:#2563eb;
    color:#fff;
    font-weight:600;
    cursor:pointer;
    font-size:16px;
    transition:background-color 0.3s, box-shadow 0.3s;
  }
  button[onclick="login()"]:hover{
    background:#1d4ed8;
    box-shadow:0 4px 15px rgba(37, 99, 235, 0.3);
  }
  
  /* Muted Text */
  .muted{
    font-size:14px;
    color:#6b7280;
    margin-top:15px;
    text-align:center;
  }
  
  /* Message Area */
  #msg{
    margin-top:15px;
    font-size:15px;
    text-align:center;
    padding:10px;
    border-radius:8px;
  }
</style>

</head>
<body>
<div class="box">

  <div class="logo-container">
    <img src="res/logo.png" alt="Company Logo" class="logo">
  </div>

  <h2>ðŸ“ž Dashboard Login</h2>

  <div id="loginBox">
    <input id="username" placeholder="Username" autocomplete="username">
    
    <div class="password-container">
      <input id="password" type="password" placeholder="Password" autocomplete="current-password">
      <button type="button" class="toggle-password" onclick="togglePasswordVisibility()">
        <span id="toggleIcon" class="material-symbols-outlined">visibility_off</span>
      </button>
    </div>
    
    <button onclick="login()">Secure Login</button>
    <div class="muted">Enter correct username & password to access the secure dashboard.</div>
  </div>

  <div id="msg"></div>

</div>

<script>
// USER DATA (same as before)
const USERS = {
  "admin": {
     // password = admin123
     passwordHash: "9667a43bca5f7472d3e1b25c1cf6f831960c9bdd5eaaf19a99d426f9739b29e1",
  }
};

// SHA-256 hash
async function sha256hex(str){
  const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
}

// show message
function msg(text, bad=false){
  const m = document.getElementById("msg");
  m.style.color = bad ? "#991b1b" : "#065f46"; 
  m.style.backgroundColor = bad ? "#fee2e2" : "#d1fae5";
  m.innerText = text;
}

// Function to toggle password visibility (Updated for Google Material Icons)
function togglePasswordVisibility() {
  const passwordInput = document.getElementById('password');
  const toggleIcon = document.getElementById('toggleIcon');
  
  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    // Change icon to visibility (Shown state)
    toggleIcon.innerText = 'visibility'; 
  } else {
    passwordInput.type = 'password';
    // Change icon back to visibility_off (Hidden state)
    toggleIcon.innerText = 'visibility_off'; 
  }
}


// login function (NO OTP)
async function login(){
  msg("");

  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value;

  // Disable button during process
  const loginButton = document.querySelector('button[onclick="login()"]');
  loginButton.disabled = true;

  if(!u || !p){ 
    msg("Please enter both username and password.", true); 
    loginButton.disabled = false;
    return; 
  }

  const user = USERS[u];
  if(!user){ 
    msg("Invalid credentials. Please check your details.", true); 
    loginButton.disabled = false;
    return; 
  }

  try {
    const hash = await sha256hex(p);
    if(hash !== user.passwordHash){ 
      msg("Invalid credentials. Please check your details.", true); 
      loginButton.disabled = false;
      return;
    }
  } catch (error) {
    // Handle potential hashing errors
    msg("An error occurred during authentication.", true);
    loginButton.disabled = false;
    return;
  }

  // SUCCESS
  msg("Login successful! Redirecting to dashboard...", false);

  // FIX: Using sessionStorage instead of localStorage
  sessionStorage.setItem("auth", "1");

  setTimeout(()=>{
    window.location.href = "dashboard.html";
  }, 600);
}
</script>

</body>
</html>
